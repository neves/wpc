#!/bin/sh

# this script just execute the commandline generated by vwp.js,
# instead of running webpack from node. It's less intrusive,
# you can just copy the generated command and run yourself directly.

# add local and global node_modules to the path
# https://gist.github.com/branneman/8048520#4-the-environment

js=$(node -e "console.log(require('fs').realpathSync('$0'))")
cmd=$(node "$js.js" "$@")
exit_status=$?

if [ $exit_status -eq 0 ]
then
  echo "\n\033[0;36m$cmd\033[0m\n" 1>&2 # show command in blue
  # echo $cmd | sh
  sh -c "$cmd"
  exit $?
else
  echo "\033[0;31m$cmd\033[0m" 1>&2 # show error message in red
  exit $exit_status
fi
